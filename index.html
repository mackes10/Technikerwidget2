<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Technikerwidget2</title>
</head>
<body>
  <label for="mitarbeiter">Mitarbeiter auswählen:</label>
  <select id="mitarbeiter" name="value">
    <option value="">Bitte auswählen</option>
    <option value="Option A">Option A</option>
    <option value="Option B">Option B</option>
    <option value="Option C">Option C</option>
  </select>

  <script>
    const select = document.getElementById("mitarbeiter");

    // Funktion um Widget-Wert zu setzen - funktioniert mit Jotform
    function setWidgetValue(value) {
      if (window.JotForm && typeof window.JotForm.setWidgetValue === "function") {
        window.JotForm.setWidgetValue(value);
      } else if (window.widgetAPI && typeof window.widgetAPI.setValue === "function") {
        window.widgetAPI.setValue(value);
      } else {
        // Fallback: Sende PostMessage an Parent
        parent.postMessage({
          type: "control_widget",
          name: "value",
          value: value
        }, "*");
      }
    }

    select.addEventListener("change", () => {
      const selectedValue = select.value;
      console.log("Sende Wert:", selectedValue);

      // Wert setzen
      setWidgetValue(selectedValue);
    });

    // Optional: Widget initialisieren, falls Wert bereits gesetzt wurde
    window.addEventListener('message', function(event) {
      if (event.data && event.data.type === 'control_widget' && event.data.name === 'value') {
        select.value = event.data.value;
      }
    });
  </script>
</body>
</html>
